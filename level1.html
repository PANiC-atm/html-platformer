<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Level 1</title>
  <style>
    body { margin:0; background:black; display:flex; justify-content:center; align-items:center; height:100vh; }
    canvas { border:1px solid white; background:black; }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="512" height="384"></canvas>
  <script src="player.js"></script>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const BLOCK_SIZE = 64;

    const bg = new Image();
    bg.src = "images/levelBG.png";

    const blockImg = new Image();
    blockImg.src = "images/levelblock.png";

    const levelMap = [
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "........................................##......................................",
      "....................................##..##......................................",
      "................................##..##..##......................................",
      "#########...##################..##..##..##.....############......................",
      "#########...##################..##..##..##.....############......................",
    ];

    // store blocks
    let blocks = [];
    for (let row = 0; row < levelMap.length; row++) {
      for (let col = 0; col < levelMap[row].length; col++) {
        if (levelMap[row][col] === "#") {
          blocks.push({
            x: col * BLOCK_SIZE,
            y: row * BLOCK_SIZE,
            size: BLOCK_SIZE
          });
        }
      }
    }

    // --- Camera ---
    let camera = { x: 0, y: 0 };

    function gameLoop() {
      // Clear screen
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Update camera (follow player)
      if (window.player) {
        camera.x = window.player.x - canvas.width / 2 + window.player.width / 2;
        if (camera.x < 0) camera.x = 0; // prevent scrolling past left edge
      }

      // background
      ctx.drawImage(bg, -camera.x, -camera.y, canvas.width, canvas.height);

      // draw blocks with camera offset
      blocks.forEach(b => {
        ctx.drawImage(blockImg, b.x - camera.x, b.y - camera.y, b.size, b.size);
      });

      // player
      if (window.playerUpdate) {
        window.playerUpdate(ctx, canvas, blocks, camera);
      }

      requestAnimationFrame(gameLoop);
    }

    bg.onload = () => { gameLoop(); };
  </script>
</body>
</html>
