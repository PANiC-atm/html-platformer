<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Level 1</title>
  <style>
    body { margin: 0; background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; }
    canvas { border: 1px solid white; }
  </style>
</head>
<body>
<canvas id="game" width="512" height="384"></canvas>

<!-- Load player logic -->
<iframe src="player.html" style="display:none;"></iframe>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Load background
const bg = new Image();
bg.src = "images/levelBG.png";

// Block settings
const blockImg = new Image();
blockImg.src = "images/levelblock.png";
const BLOCK_SIZE = 32; // smaller blocks

// Level layout (# = block, . = empty)
    const levelMap = [
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "................................................................................",
      "........................................##......................................",
      "....................................##..##......................................",
      "................................##..##..##......................................",
      "#########.......##############..##..##..##.....############......................",
      "#########.......##############..##..##..##.....############......................",
    ];

// Convert map into block objects
let blocks = [];
function buildLevel() {
  blocks = [];
  for (let row = 0; row < levelMap.length; row++) {
    for (let col = 0; col < levelMap[row].length; col++) {
      if (levelMap[row][col] === "#") {
        blocks.push({ x: col * BLOCK_SIZE, y: row * BLOCK_SIZE });
      }
    }
  }
}
buildLevel();

// Spawn point for player
const spawnPoint = { x: 64, y: 200 };

// Main game loop
function loop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw background scaled to canvas
  ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);

  // Draw blocks
  blocks.forEach(b => {
    ctx.drawImage(blockImg, b.x, b.y, BLOCK_SIZE, BLOCK_SIZE);
  });

  // Update + draw player (from player.html)
  if (window.playerUpdate) {
    window.playerUpdate(ctx, blocks, canvas, spawnPoint);
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
